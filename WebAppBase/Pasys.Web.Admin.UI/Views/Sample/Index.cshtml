@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
<nav class="navbar navbar-default navbar-breadcrumb" role="navigation">
    <div class="container-fluid">
        <div class="collapse navbar-collapse">
            <form class="navbar-form navbar-left">
                <a class="btn btn-primary" href='@Url.Action("Create")' role="button">新規...</a>
                <a class="btn btn-danger" id="btnDelete" role="button">削除...</a>
            </form>
            <form class="navbar-form navbar-right" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="検索">
                </div>
                <button type="submit" class="btn btn-default">検索</button>
            </form>

        </div>
    </div>
</nav>

<div id="gridContainer">
    <table id="jqGrid"></table>
    <div id="jqGridPager"></div>
</div>

@section Script{

    <script type="text/javascript">

        $(document).ready(function () {

            var jqDataUrl = '@Url.Action("LoadjqData")';
            // Setup grid
            jQuery("#jqGrid").jqGrid({
                // Ajax related configurations
                url: jqDataUrl,
                datatype: "json",
                mtype: "GET",
                loadonce: true,
                //shrinkToFit: false,
                height: 'auto',
                autowidth: true,
                multiselect: true,//复选框
                rowNum: 10,
                rowList: [10, 20, 30],
                colNames: ['ID', '登録日', 'タイトル', '事業所', '登録者'],
                colModel: [
                    { label: "ID", name: 'NoticeID', index: 'NoticeID', width: '10%', sortable: false, hidden: false, frozen: true, align: "center" },
                    { label: "登録日", name: 'NoticeDateTime', index: 'NoticeDateTime', width: '10%', align: "center", sortable: false, frozen: true },
                    { label: "タイトル", name: 'Title', index: 'Title', width: '20%', sortable: false },
                    { label: "事業所", name: 'OfficeName', index: 'OfficeName', width: '20%', align: "center", sortable: false },
                    { label: "登録者", name: 'UserName', index: 'UserName', width: '40%', sortable: false }
                ],
                pager: "#jqGridPager",
                gridComplete: function () {
                    $("#jqGrid").jqGrid("setFrozenColumns");
                    //$(".expandEnableTitle").click();
                },
                edit: false
            });
            // Set grid width to #content
            //$("#jqGrid").jqGrid('setGridWidth', $("#gridContainer").width(), true);
            $("#btnDelete").bind("click", getSelecteds);

        });


        function getSelecteds() {
            //获取多选到的id集合
            var ids = $("#jqGrid").jqGrid("getGridParam", "selarrrow");
            //遍历访问这个集合
            $(ids).each(function (index, id) {
                //由id获得对应数据行
                var row = $("#jqGrid").jqGrid('getRowData', id);
                alert("row.ID:" + row.ID + "  " + "row.fieldName:" + row.fieldName);
            });
        }

    </script>
}

